{# Row actions for audit list view - user/request filter buttons #}
{% set diffsWithMeta = item.getDiffs(true) %}
{% set requestId = diffsWithMeta['@context']['request_id']|default(null) %}
{% set hasTimelineSupport = dataSource is defined and dataSource.hasTimelineSupport() %}
{% set createdAt = item.getCreatedAt() %}

<div class="btn-group btn-group-sm" role="group">
    {% if hasTimelineSupport %}
        {% if requestId %}
            <a href="?columnFilters[request_id]={{ requestId|url_encode }}" class="btn btn-outline-info" title="Show all changes from the same HTTP request">
                <span class="material-icons" style="font-size: 1rem;">link</span>
            </a>
        {% endif %}
        {% if item.getUsername() and createdAt %}
            <twig:K:Audit:TimelineLink :item="item" :dataSource="dataSource" class="btn btn-outline-primary" />
        {% elseif item.getUsername() %}
            {# Show all changes by this user (no date filter) #}
            <a href="?columnFilters[blame_user]={{ item.getUsername()|url_encode }}"
               class="btn btn-outline-primary"
               title="Show all changes by {{ item.getUsername() }}">
                <span class="material-icons" style="font-size: 1rem;">person</span>
            </a>
        {% endif %}
    {% endif %}
</div>
